"use strict";(self.webpackChunkapp_cc=self.webpackChunkapp_cc||[]).push([[4],{4829:(e,a,s)=>{s.r(a),s.d(a,{default:()=>f});var t=s(2791),r=s(97),n=s.n(r),l=s(6871),i=s(4619),o=s(1006),c=s(840),d=s(1649),h=s(7485),_=s(5409),u=s(1477),x=s(9757),A=s(9775),j=s(1595),g=s(4455),p=s(2967),S=s(5808);const m={grandArea:"style_grandArea__VKVYI",_area_teclado:"style__area_teclado__DcU7K",webcam_area:"style_webcam_area__5KiUq",cam:"style_cam__JgYqJ",area_header_info_patient:"style_area_header_info_patient__-nYah",_area_photo_and_chapa:"style__area_photo_and_chapa__AOeCR",_area_inputs:"style__area_inputs__C1B6H",btn_save:"style_btn_save__42dbH",input_chapa:"style_input_chapa__WMGBV"};var O=s(184);const f=()=>{const{isOnline:e}=(0,i.c)(),a=(0,l.s0)(),s=(0,l.TH)();let r,f;const C=(0,t.useRef)(null),v=(0,t.useRef)(null),[D,y]=(0,t.useState)([]),[b,I]=(0,t.useState)(""),[N,P]=(0,t.useState)(!1),[$,E]=(0,t.useState)(!1),[Z,w]=(0,t.useState)(!1),[B,k]=(0,t.useState)(""),[T,V]=(0,t.useState)(!1),[R,U]=(0,t.useState)(!1);(0,t.useEffect)((()=>{console.log("============= ASSINATURA SALA  =============\n"),console.log(s.state),console.log("============= FIM =================================================================\n"),s.state?y(s.state):a("/")}),[s,b,a]);const L=async(e,a,s,t,r,n,l,i)=>{switch(w(!1),console.log(`Entrou no handleError: ${JSON.stringify(e)}`),i){case 0:w(!1),U(!0);break;case 1:P(!0),await M(e,a,s,t,r,n,l)}},F=()=>{p.h.patch("/aviso",{sala:D.CODIGO_SUB_LOCALIDADE}).then((e=>{console.log("volta do aviso",e.data)}))},M=async(e,a,s,t,r,n,l)=>{console.log("Entrou no imageSave");const i={image:`${e}`,badge:`${a}`,filename:`${n}`,user:`${s}`,aviso:`${t}`,etapa:`${r}`,autenticado:`${l}`},o=await z(i);console.log(JSON.stringify(o));try{const e=await p.Z.post("/salvarHistoricoAutenticacao",i);console.log(JSON.stringify(e))}catch(c){console.log(`error imageSave: ${c}`)}},z=async e=>{const a=p.Z.post("/uploadImage",e);console.log(a)},H=async(a,t)=>{if(w(!0),!e)return void alert("Voc\xea est\xe1 sem acesso \xe0 internet!");const r={imageSource:`${a}`,internCode:1,keyName:`${t}`,option:"compare",PAPEL_ACAO:156};try{const e=await p.Z.get(`/retornaCodUsuario?codchapa=${v.current.value}`);if(!e.data[0]){const e=(await p.Z.get(`/erroUserCracha/${t}`)).data;return w(!1),k(`${e}`),void V(!0)}const n=e.data[0].CD_USUARIO;if(console.log(n),f=await p.h.post("/rekognition/face",r),!1===f.data[0].resposta||f.data[0].user!==n)return void await L(a,t,f.data[0].user,s.state.DADOS.COD_AVISO,s.state.DADOS.PROX_ETAPA,`${t}_${f.data[0].user}_${s.state.DADOS.COD_AVISO}_${s.state.DADOS.PROX_ETAPA}`,"N",f.data[0].codigo);await(async(e,a,s,t,r,n,l)=>{w(!1),console.log("Entrou no handleSuccess"),F(),E(!0),M(e,a,s,t,r,n,l)})(a,t,f.data[0].user,s.state.DADOS.COD_AVISO,s.state.DADOS.PROX_ETAPA,`${t}_${f.data[0].user}_${s.state.DADOS.COD_AVISO}_${s.state.DADOS.PROX_ETAPA}`,"S"),await J(f.data[0].user)}catch(n){console.log(n)}},J=async e=>{const s=new Date,t=s.getDate().toString().padStart(2,"0"),n=(s.getMonth()+1).toString().padStart(2,"0"),l=`${s.getFullYear().toString()}-${n}-${t}T${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`,i={avisoCirurgia:D.DADOS.COD_AVISO,dtEtapa:l,cdEtapa:D.CODIGO_PROX_ETAPA,usuario:e,salaCirurgia:D.CODIGO_SALA,tipoAcao:"I",sublocalidade:D.CODIGO_SUB_LOCALIDADE};r=await p.Z.post("/avancarEtapasCirurgia",i),r||await L(),console.log(r),setTimeout(await(async()=>{a("/")})(),5e4)},G=`Indu\xe7\xe3o L${JSON.parse(localStorage.getItem("CAPP-local")).SUBLOCALIDADE.split(" ")[1]}`;return(0,O.jsxs)(o.Z,{title:d.Q.INDUCAO_ASSINATURA_SALA.text,children:[(0,O.jsx)(x.Z,{titulo:G,localidade:"Assinatura Sala",children:(0,O.jsxs)(A.ZP,{children:[(0,O.jsx)(A.Z_,{children:(0,O.jsx)(_.Z,{color:"light",icon:"menu",isLight:!0,children:(0,O.jsx)("p",{children:" "})})}),(0,O.jsx)(A.h_,{children:(0,O.jsx)(A.hP,{onClick:()=>(localStorage.removeItem("CAPP-local"),void a("/")),children:"Alterar Local"})})]})}),(0,O.jsxs)(c.Z,{children:[(0,O.jsxs)("div",{className:m.container,children:[(0,O.jsx)("header",{children:(0,O.jsx)("div",{children:(0,O.jsx)(j.ZP,{className:m.area_header_info_patient,children:(0,O.jsxs)(j.eW,{children:[(0,O.jsx)("h3",{children:"Paciente"}),(0,O.jsx)("h1",{children:D.DADOS?D.DADOS.PACIENTE:"- - "})]})})})}),(0,O.jsxs)("main",{className:m.grandArea,children:[(0,O.jsx)("div",{className:m._area_photo_and_chapa,children:(0,O.jsx)("div",{className:m.webcam_area,children:(0,O.jsx)(n(),{ref:C,className:m.cam,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{width:540,height:880,facingMode:"user"}})})}),(0,O.jsx)("div",{className:m._area_teclado,children:(0,O.jsxs)("div",{style:{padding:"1rem"},children:[(0,O.jsxs)("div",{style:{width:"400px"},children:[(0,O.jsx)("h2",{children:"Informe o c\xf3digo do crach\xe1"}),(0,O.jsx)(h.Z,{className:m.input_chapa,type:"number",disabled:!0,ref:v}),(0,O.jsx)("br",{})]}),(0,O.jsx)("div",{style:{width:"400px"},children:(0,O.jsx)(S.Z,{childToParent:e=>{const a=e;if("apagar"===a){const e=v.current.value.substring(0,v.current.value.length-1);v.current.value=e,console.log(`Valor do input: ${v.current.value}`)}else"zerar"===a?(v.current.value="",console.log(`Valor do input: ${v.current.value}`)):(I(a),v.current.value+=a)}})}),(0,O.jsxs)("div",{className:m._area_inputs,children:[(0,O.jsx)("div",{children:(0,O.jsx)(_.Z,{className:m.btn_save,color:"success",icon:"user",onClick:()=>{const e=C.current.getScreenshot().replace("data:image/jpeg;base64,","");H(e,v.current.value)},children:"Assinar"})}),(0,O.jsx)("div",{children:(0,O.jsx)(g.Z,{onClick:()=>a(-1),icon:"reply",color:"#fff",size:"5x",forceFamily:"material"})})]})]})})]})]}),(0,O.jsxs)(u.ZP,{isCentered:!0,isAnimation:!1,id:"example-modal",isOpen:N,titleId:"example-title",children:[(0,O.jsx)(u.xB,{style:{backgroundColor:"#FE5B3A",color:"#fff"},children:(0,O.jsx)(u.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(u.fe,{className:"ModalBody",children:[(0,O.jsxs)("h1",{children:["Usu\xe1rio n\xe3o encontrado",(0,O.jsx)("br",{})]}),"Por favor, tente novamente."]}),(0,O.jsx)(u.mz,{children:(0,O.jsx)(_.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(_.Z,{className:"btn-style",color:"success",icon:"done",onClick:()=>{P(!1)},children:"FECHAR"})})})]}),(0,O.jsxs)(u.ZP,{isCentered:!0,isAnimation:!1,id:"sucess-modal",isOpen:$,titleId:"example-titlea",children:[(0,O.jsx)(u.xB,{style:{backgroundColor:"#37BBAA",color:"#fff"},children:(0,O.jsx)(u.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(u.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:"ASSINADO COM SUCESSO!"}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]}),(0,O.jsxs)(u.ZP,{isCentered:!0,isAnimation:!1,id:"loading",isOpen:Z,titleId:"loading",children:[(0,O.jsx)(u.xB,{style:{backgroundColor:"#636363",color:"#fff"},children:(0,O.jsx)(u.r6,{id:"example-title",children:"ASSINANDO..."})}),(0,O.jsxs)(u.fe,{className:"ModalBody",children:[(0,O.jsx)("br",{}),(0,O.jsx)("h1",{children:"Assinando...Por favor, aguarde..."}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]}),(0,O.jsxs)(u.ZP,{isCentered:!0,isAnimation:!1,isOpen:T,children:[(0,O.jsx)(u.xB,{style:{backgroundColor:"#FE5B3A",color:"#fff"},children:(0,O.jsx)(u.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(u.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:B}),(0,O.jsx)("br",{})]}),(0,O.jsx)(u.mz,{children:(0,O.jsx)(_.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(_.Z,{className:"btn-style",color:"light",onClick:()=>V(!1),children:"FECHAR"})})})]}),(0,O.jsxs)(u.ZP,{isCentered:!0,isAnimation:!1,isOpen:R,children:[(0,O.jsx)(u.xB,{style:{backgroundColor:"#FE5B3A",color:"#fff"},children:(0,O.jsx)(u.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(u.fe,{className:"ModalBody",children:[(0,O.jsxs)("h1",{children:["Face n\xe3o cadastrada!",(0,O.jsx)("br",{})]}),(0,O.jsx)("h3",{children:"Por favor, realize o cadastro e tente novamente."})]}),(0,O.jsx)(u.mz,{children:(0,O.jsx)(_.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(_.Z,{className:"btn-style",color:"light",onClick:()=>U(!1),children:"FECHAR"})})})]})]})]})}}}]);
//# sourceMappingURL=4.155bd727.chunk.js.map