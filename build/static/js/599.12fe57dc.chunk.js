"use strict";(self.webpackChunkapp_cc=self.webpackChunkapp_cc||[]).push([[599],{6351:(e,a,s)=>{s.r(a),s.d(a,{default:()=>C});var t=s(2791),r=s(97),l=s.n(r),i=s(6871),c=s(4619),n=s(1006),o=s(840),d=s(1649),h=s(7485),u=s(5409),x=s(1477),_=s(9757),j=s(9775),m=s(1595),p=s(4455),A=s(2967),S=s(5808);const g={grandArea:"style_grandArea__BN4fV",_area_teclado:"style__area_teclado__D9piE",webcam_area:"style_webcam_area__h8Euf",cam:"style_cam__JInq4",area_header_info_patient:"style_area_header_info_patient__eOoiS",_area_photo_and_chapa:"style__area_photo_and_chapa__uJo-S",_area_inputs:"style__area_inputs__8iwO7",btn_save:"style_btn_save__HZ4H5",input_chapa:"style_input_chapa__3c5HH"};var O=s(184);const C=()=>{const{isOnline:e}=(0,c.c)(),a=(0,i.s0)(),s=(0,i.TH)(),r=(0,t.useRef)(null),C=(0,t.useRef)(null),[y,D]=(0,t.useState)([]),[v,f]=(0,t.useState)(""),[N,b]=(0,t.useState)(!1),[I,w]=(0,t.useState)(!1),[E,Z]=(0,t.useState)({}),[P,k]=(0,t.useState)(!1),[T,$]=(0,t.useState)(!1),[R,B]=(0,t.useState)(""),[L,U]=(0,t.useState)(!1),[V,z]=(0,t.useState)(!1);let H;(0,t.useEffect)((()=>{Z({...s.state}),console.log(s.state),s.state?D(s.state):a("/")}),[s,v,a]);const M=async(e,a,s,t,r,l,i)=>{console.log("Entrou no imageSave");const c={image:`${e}`,badge:`${a}`,filename:`${l}`,user:`${s}`,aviso:`${t}`,etapa:`${r}`,autenticado:`${i}`},n=await J(c);console.log(JSON.stringify(n));try{await A.Z.post("/salvarHistoricoAutenticacao",c)}catch(o){console.log(`error imageSave: ${o}`)}},J=async e=>{const a=await A.Z.post("/uploadImage",e);console.log(a)},F=async(a,t)=>{if(k(!0),!e)return void alert("Voc\xea est\xe1 sem acesso \xe0 internet!");const r={imageSource:`${a}`,internCode:1,keyName:`${t}`,option:"compare",PAPEL_ACAO:156};try{const e=await A.Z.get(`/retornaCodUsuario?codchapa=${C.current.value}`);if(!e.data[0]){const e=(await A.Z.get(`/erroUserCracha/${t}`)).data;return k(!1),B(`${e}`),void U(!0)}const l=e.data[0].CD_USUARIO;H=await A.h.post("/rekognition/face",r),console.log(H.data),console.log("dadosRedirect",E),console.log(l);const i=JSON.parse(localStorage.getItem("CAPP-local"));if(!1===H.data[0].resposta||H.data[0].user!==l)return await(async(e,a,s,t,r,l,i,c)=>{switch(k(!1),console.log(`Entrou no handleError: ${JSON.stringify(e)}`),c){case 0:k(!1),z(!0);break;case 1:b(!0),await M(e,a,s,t,r,l,i)}})(a,t,H.data[0].user,s.state.DADOS.DADOS.COD_AVISO,null,`${t}_${H.data[0].user}_null_null`,"N",H.data[0].codigo),console.log("checklist 2",s.state.CHECKLIST),await K(H.data[0].user,s.state.CHECKLIST),void await G(H.data[0].user);switch(s.state.TP_ACAO){case"ALTERAR_DATA_JEJUM":await(async(e,a,s,t,r,l,i)=>{k(!1),w(!0),await M(e,a,s,t,r,l,i)})(a,t,H.data[0].user,s.state.DADOS.DADOS.COD_AVISO,null,`${t}_${H.data[0].user}_null_null`,"S"),await K(H.data[0].user,s.state.CHECKLIST),await G(H.data[0].user);break;case"CANCELAR_CIRURGIA":await M(a,t,H.data[0].user,s.state.DADOS.DADOS.COD_AVISO,null,`${t}_${H.data[0].user}_null_null`,"S"),await q(s.state.DADOS.DADOS.COD_AVISO,H.data[0].user,s.state.MOTIVO,i.CODIGO_SUBLOCALIDADE)}}catch(l){console.log(l)}},K=async(e,a)=>{try{const s=await A.Z.post("/insertRepostasChecklist",{questionsCheckList:a,Usuario:e});await s.data[0]&&console.log("Sucesso!")}catch(s){console.log(s)}},q=async(e,s,t,r)=>{const l=(await A.Z.post("/suspenderCirurgia",{CD_AVISO:e,CD_USUARIO:s,CD_AVISO_CANCELAMENTO:t,CD_SUB_LOCALIDADE:r})).data;console.log(l),l?(k(!1),w(!0),setTimeout((()=>a("/")),3e3)):(k(!1),$(!0),setTimeout((()=>a("/")),3e3))},G=async e=>{console.log(e),setTimeout(await(async()=>{a("/")})(),8e4)};return(0,O.jsxs)(n.Z,{title:d.Q.PREPARO_ASSINATURA_ALTERACOES.text,children:[(0,O.jsx)(_.Z,{titulo:"Sala de Preparo",localidade:"Assinatura Colaborador",children:(0,O.jsxs)(j.ZP,{children:[(0,O.jsx)(j.Z_,{children:(0,O.jsx)(u.Z,{color:"light",icon:"menu",isLight:!0,children:(0,O.jsx)("p",{children:" "})})}),(0,O.jsx)(j.h_,{children:(0,O.jsx)(j.hP,{onClick:()=>(localStorage.removeItem("CAPP-local"),void a("/")),children:"Alterar Local"})})]})}),(0,O.jsxs)(o.Z,{children:[(0,O.jsxs)("div",{className:g.container,children:[(0,O.jsx)("header",{children:(0,O.jsx)("div",{children:(0,O.jsx)(m.ZP,{className:g.area_header_info_patient,children:(0,O.jsxs)(m.eW,{children:[(0,O.jsx)("h3",{children:"Paciente"}),(0,O.jsx)("h1",{children:y.DADOS?y.DADOS.DADOS.PACIENTE:"- - "})]})})})}),(0,O.jsxs)("main",{className:g.grandArea,children:[(0,O.jsx)("div",{className:g._area_photo_and_chapa,children:(0,O.jsx)("div",{className:g.webcam_area,children:(0,O.jsx)(l(),{ref:r,className:g.cam,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{width:540,height:880,facingMode:"user"}})})}),(0,O.jsx)("div",{className:g._area_teclado,children:(0,O.jsxs)("div",{style:{padding:"1rem"},children:[(0,O.jsxs)("div",{style:{width:"400px"},children:[(0,O.jsx)("h2",{children:"Informe o c\xf3digo do crach\xe1"}),(0,O.jsx)(h.Z,{className:g.input_chapa,type:"number",disabled:!0,ref:C}),(0,O.jsx)("br",{})]}),(0,O.jsx)("div",{style:{width:"400px"},children:(0,O.jsx)(S.Z,{childToParent:e=>{const a=e;if("apagar"===a){const e=C.current.value.substring(0,C.current.value.length-1);C.current.value=e}else"zerar"===a?C.current.value="":(f(a),C.current.value+=a)}})}),(0,O.jsxs)("div",{className:g._area_inputs,children:[(0,O.jsx)("div",{children:(0,O.jsx)(u.Z,{className:g.btn_save,color:"success",icon:"user",onClick:()=>{const e=r.current.getScreenshot().replace("data:image/jpeg;base64,","");F(e,C.current.value)},children:"Assinar"})}),(0,O.jsx)("div",{children:(0,O.jsx)(p.Z,{onClick:()=>a(-1),icon:"reply",color:"#fff",size:"5x",forceFamily:"material"})})]})]})})]})]}),(0,O.jsxs)(x.ZP,{id:"example-modal",isOpen:N,titleId:"example-title",children:[(0,O.jsx)(x.xB,{className:"modal-header-error",children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsxs)("h1",{children:["Usu\xe1rio n\xe3o encontrado",(0,O.jsx)("br",{})]}),"Por favor, tente novamente."]}),(0,O.jsx)(x.mz,{children:(0,O.jsx)(u.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(u.Z,{className:"btn-style",color:"success",icon:"done",onClick:()=>{b(!1)},children:"FECHAR"})})})]}),(0,O.jsxs)(x.ZP,{id:"modalAutorizacaoSusp",isOpen:T,titleId:"modalAutorizacaoSusp",children:[(0,O.jsx)(x.xB,{style:{backgroundColor:"#E5684C"},children:(0,O.jsx)(x.r6,{id:"example-title",children:"ATEN\xc7\xc3O"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:"Voc\xea n\xe3o possui autoriza\xe7\xe3o para suspender essa cirurgia!"}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]}),(0,O.jsxs)(x.ZP,{id:"sucess-modal",isOpen:I,titleId:"example-titlea",children:[(0,O.jsx)(x.xB,{style:{backgroundColor:"#37BBAA"},children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:"ASSINADO COM SUCESSO!"}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]}),(0,O.jsxs)(x.ZP,{id:"loading",isOpen:P,titleId:"loading",children:[(0,O.jsx)(x.xB,{style:{backgroundColor:"#636363"},children:(0,O.jsx)(x.r6,{id:"example-title",children:"ASSINANDO..."})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("br",{}),(0,O.jsx)("h1",{children:"Assinando...Por favor, aguarde..."}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]}),(0,O.jsxs)(x.ZP,{isOpen:L,children:[(0,O.jsx)(x.xB,{className:"modal-header-error",children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:R}),(0,O.jsx)("br",{})]}),(0,O.jsx)(x.mz,{children:(0,O.jsx)(u.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(u.Z,{className:"btn-style",color:"light",onClick:()=>U(!1),children:"FECHAR"})})})]}),(0,O.jsxs)(x.ZP,{isOpen:V,children:[(0,O.jsx)(x.xB,{className:"modal-header-error",children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsxs)("h1",{children:["Face n\xe3o cadastrada!",(0,O.jsx)("br",{})]}),(0,O.jsx)("h3",{children:"Por favor, realize o cadastro e tente novamente."})]}),(0,O.jsx)(x.mz,{children:(0,O.jsx)(u.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(u.Z,{className:"btn-style",color:"light",onClick:()=>z(!1),children:"FECHAR"})})})]})]})]})}}}]);
//# sourceMappingURL=599.12fe57dc.chunk.js.map