"use strict";(self.webpackChunkapp_cc=self.webpackChunkapp_cc||[]).push([[798],{1842:(e,a,t)=>{t.r(a),t.d(a,{default:()=>T});var A=t(2791),i=t(6871),o=t(5409),l=t(1595),r=t(840),s=t(9775),n=t(1477),O=t(1006),D=t(1649),I=t(9757),d=t(2967),C=t(5071),c=t(184);const T=()=>{const e=(0,i.s0)(),a=(0,i.TH)(),[t,T]=(0,A.useState)(!1),[_,S]=(0,A.useState)(null),[u,L]=(0,A.useState)(!1),[p,E]=(0,A.useState)({COR:"",MSG:"",TITULO:""}),[g,m]=(0,A.useState)(Date.now()),[P,x]=(0,A.useState)([]),[h,G]=(0,A.useState)([]),[R,U]=(0,A.useState)(""),[f,j]=(0,A.useState)(""),w=JSON.parse(localStorage.getItem("CAPP-local")),V=`Sala ${"Hemodinamica"===w.SUBLOCALIDADE?w.SUBLOCALIDADE:w.SUBLOCALIDADE.split(" ")[1]}`,v=async(e,t)=>{const A=JSON.parse(localStorage.getItem("responsavel_recebimento"));if(!A)return!1;const i={avisoCirurgia:a.state.AVISO,dtEtapa:t,cdEtapa:e,usuario:A.USUARIO,salaCirurgia:w.CODIGO_SALA_CIRURGICA,tipoAcao:"I",sublocalidade:w.CODIGO_SUBLOCALIDADE};return!!await d.Z.post("/avancarEtapasCirurgia",i)},F=async t=>{const A=new Date;A.setMinutes(A.getMinutes()-A.getTimezoneOffset());const i=A.toISOString().slice(0,16);return e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"NOVA",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:i,PAPEL_PERMITIDO:160===t||170===t?222:156}}),!0};async function B(t,A){if(0===t)if(null!==P[0].DT_ETAPA){const i=(await d.Z.get(`/retornaHorarioSaidaSala/${a.state.AVISO}`)).data;if(new Date(A).getTime()<new Date(i.SAIDA_SALA_SO).getTime())return L(!0),E({COR:"#FF7455",MSG:"A data de in\xedcio n\xe3o pode ser menor do que a sa\xedda de sala do paciente!",TITULO:"AVISO"}),!1;e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"ALTERACAO",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:A,PAPEL_PERMITIDO:156}})}else{const i=(await d.Z.get(`/retornaHorarioSaidaSala/${a.state.AVISO}`)).data;if(new Date(A).getTime()<new Date(i.SAIDA_SALA_SO).getTime())return L(!0),E({COR:"#FF7455",MSG:"A data de in\xedcio n\xe3o pode ser menor do que a sa\xedda de sala do paciente!",TITULO:"AVISO"}),!1;e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"NOVA",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:A,PAPEL_PERMITIDO:156}})}if(160===t){if(null!==P[1].DT_ETAPA){const i=(await d.Z.get(`/retornaHorarioSaidaSala/${a.state.AVISO}`)).data;return new Date(A).getTime()<new Date(i.SAIDA_SALA_SO).getTime()?(L(!0),E({COR:"#FF7455",MSG:"A data de in\xedcio n\xe3o pode ser menor do que a sa\xedda de sala do paciente!",TITULO:"AVISO"}),!1):new Date(A).getTime()<new Date(P[0].DT_ETAPA).getTime()?(L(!0),E({COR:"#FF7455",MSG:"A data de in\xedcio n\xe3o pode ser menor do que a de solicita\xe7\xe3o da limpeza!",TITULO:"AVISO"}),!1):(e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"ALTERACAO",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:A,PAPEL_PERMITIDO:222}}),!0)}const i=(await d.Z.get(`/retornaHorarioSaidaSala/${a.state.AVISO}`)).data;return new Date(A).getTime()<new Date(i.SAIDA_SALA_SO).getTime()?(L(!0),E({COR:"#FF7455",MSG:"A data de in\xedcio n\xe3o pode ser menor do que a sa\xedda de sala do paciente!",TITULO:"AVISO"}),!1):new Date(A).getTime()<new Date(P[0].DT_ETAPA).getTime()?(L(!0),E({COR:"#FF7455",MSG:"A data de in\xedcio n\xe3o pode ser menor do que a de solicita\xe7\xe3o da limpeza!",TITULO:"AVISO"}),!1):(console.log(i),e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"NOVA",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:A,PAPEL_PERMITIDO:222}}),!0)}return 170!==t||(null!==P[2].DT_ETAPA?new Date(A).getTime()<new Date(P[1].DT_ETAPA).getTime()?(L(!0),E({COR:"#FF7455",MSG:"A data de fim n\xe3o pode ser menor do que a data de in\xedcio!",TITULO:"AVISO"}),!1):(e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"ALTERACAO",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:A,PAPEL_PERMITIDO:222}}),!0):new Date(A).getTime()<new Date(P[1].DT_ETAPA).getTime()?(L(!0),E({COR:"#FF7455",MSG:"A data de fim n\xe3o pode ser menor do que a data de in\xedcio!",TITULO:"AVISO"}),!1):(e("/salaCirurgica/AssinaturaLimpeza",{state:{TIPO:"NOVA",CODIGO_LOCALIDADE:w.CODIGO_LOCALIDADE,CODIGO_AVISO:a.state.AVISO,CODIGO_SUB_LOCALIDADE:w.CODIGO_SUBLOCALIDADE,CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA,ETAPA:t,DATA:A,PAPEL_PERMITIDO:222}}),!0))}(0,A.useEffect)((()=>{console.warn("DEBUG"),console.log("============= O QUE EST\xc1 CHEGANDO POR PAR\xc2METRO  ==================================\n"),console.log(a.state),console.log("============= FIM =================================================================\n"),!0===a.state.SAIDA_SALA&&(110===a.state.CD_ETAPA||v(110,new Date),v(a.state.MOTIVO_ALTA,new Date)),localStorage.removeItem("responsavel_recebimento"),(async()=>{try{const t=await d.Z.get(`/retornaPerguntasPreparoLimpeza/${a.state.AVISO}`);x(t.data),null!==t.data[2].DT_ETAPA&&(localStorage.removeItem("avancouEtapa"),e("/salaCirurgica/preparoLimpeza"))}catch(t){console.log(t)}})();const t=setInterval((()=>m(Date.now())),3e4);return()=>{clearInterval(t)}}),[a,e,g]);return(0,c.jsxs)(O.Z,{title:D.Q.SALA_CIRURGICA_LIMPEZA.text,children:[(0,c.jsx)(I.Z,{titulo:V,localidade:"Preparo e Limpeza",children:(0,c.jsxs)(s.ZP,{children:[(0,c.jsx)(s.Z_,{children:(0,c.jsx)(o.Z,{color:"light",icon:"menu",isLight:!0,children:(0,c.jsx)("p",{children:" "})})}),(0,c.jsxs)(s.h_,{children:[(0,c.jsx)(s.hP,{onClick:()=>(localStorage.removeItem("CAPP-local"),void e("/")),children:"Alterar Local"}),(0,c.jsx)(s.hP,{onClick:()=>(async()=>{console.log("proxima"),S({state:{DADOS:{COD_AVISO:a.state.AVISO,PROX_ETAPA:a.state.CD_ETAPA},CODIGO_SALA_CIRURGICA:w.CODIGO_SALA_CIRURGICA}}),T(!0)})(),children:"Pr\xf3xima Cirurgia"})]})]})}),t?(0,c.jsx)(C.Z,{location:_,codigoUsuario:t=>(t=>{T(!1);const{AVISO:A}=a.state,{CODIGO_SALA_CIRURGICA:i}=w;d.Z.patch("/proxima-cirurgia",{sala:i,aviso:A,usuario:t}).then((()=>{console.log("proxima cirurgia retorno"),e("/salaCirurgica/preparoLimpeza")}))})(t),voltar:()=>T(!1)}):(0,c.jsxs)(r.Z,{children:[(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"container",style:{marginTop:"150px"},children:(0,c.jsx)(l.ZP,{borderSize:"3",borderColor:"primary",className:"card-page",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{className:"col-sm-3 pull-right body-card ",children:(0,c.jsx)("div",{className:"ready",children:(0,c.jsx)("h1",{style:{fontWeight:"bold"},children:"Limpeza"})})}),(0,c.jsx)("div",{className:"col-sm-8",style:{padding:"15px"},children:(0,c.jsx)("div",{className:"row",children:P.map(((e,a)=>(0,c.jsx)("div",{className:"col-sm-6 ",style:{maxWidth:"200px",margin:"auto",textAlign:"center"},children:(0,c.jsxs)("div",{className:"row ",children:[(0,c.jsx)("div",{className:"col-sm-12",children:0===a?(0,c.jsx)(o.Z,{onClick:()=>{null===P[0].DT_ETAPA&&F(e.CD_ETAPA)},id:e.CD_ETAPA,style:{fontWeight:"700",fontSize:"25px",color:"#fff",height:"130px",borderRadius:"30px",backgroundColor:null===P[0].DT_ETAPA?"#FF7455":"#E13813"},color:"light",size:"large",children:e.DS_ETAPA}):1===a?(0,c.jsx)(o.Z,{onClick:()=>{null===P[0].DT_ETAPA||null===P[1].DT_ETAPA&&F(e.CD_ETAPA)},id:e.CD_ETAPA,style:{fontWeight:"700",color:"#fff",fontSize:"25px",height:"130px",borderRadius:"30px",backgroundColor:null===P[0].DT_ETAPA?"#97989B":null===P[1].DT_ETAPA?"#B2C0FF":"#4D6BF4"},color:"light",size:"large",children:e.DS_ETAPA}):2===a&&(0,c.jsx)(o.Z,{onClick:()=>{null===P[1].DT_ETAPA||null===P[2].DT_ETAPA&&F(e.CD_ETAPA)},id:e.CD_ETAPA,style:{fontWeight:"700",color:"#fff",fontSize:"25px",height:"130px",borderRadius:"30px",backgroundColor:null===P[1].DT_ETAPA?"#97989B":null===P[2].DT_ETAPA?"#B2C0FF":"#4D6BF4"},color:"light",size:"large",children:e.DS_ETAPA})}),(0,c.jsx)("div",{className:"col-sm-6",style:{marginTop:"10px",width:"auto"},children:(0,c.jsx)("div",{children:0===a?(0,c.jsx)("input",{style:{width:"190px",height:"50px",borderRadius:"30px",backgroundColor:null===P[0].DT_ETAPA?"#FF7455":"#E13813",textAlign:"center",margin:"auto",paddingTop:"1px",paddingLeft:"15px",fontWeight:"bold",fontSize:"18px",color:"white",border:"0px"},className:"input-time",onChange:a=>{U(a.target.value),B(e.CD_ETAPA,a.target.value)},type:"datetime-local",id:"data-fim",name:"date",defaultValue:e.DT_ETAPA}):1===a?(0,c.jsx)("input",{disabled:null==P[0].DT_ETAPA,style:{width:"190px",height:"50px",borderRadius:"30px",backgroundColor:null===P[0].DT_ETAPA?"#97989B":null===P[1].DT_ETAPA?"#B2C0FF":"#4D6BF4",textAlign:"center",margin:"auto",paddingTop:"1px",paddingLeft:"15px",fontWeight:"bold",fontSize:"18px",color:"white",border:"0px"},className:"input-time",onChange:a=>{U(a.target.value),B(e.CD_ETAPA,a.target.value)},type:"datetime-local",id:"data-fim",name:"date",defaultValue:e.DT_ETAPA}):2===a&&(0,c.jsx)("input",{disabled:null==P[1].DT_ETAPA,style:{width:"190px",height:"50px",borderRadius:"30px",backgroundColor:null===P[1].DT_ETAPA?"#97989B":null===P[2].DT_ETAPA?"#B2C0FF":"#4D6BF4",textAlign:"center",margin:"auto",paddingTop:"1px",paddingLeft:"15px",fontWeight:"bold",fontSize:"18px",color:"white",border:"0px"},className:"input-time",onChange:a=>{U(a.target.value),B(e.CD_ETAPA,a.target.value)},type:"datetime-local",id:"data-fim",name:"date",defaultValue:e.DT_ETAPA})})}),(0,c.jsx)("div",{className:"col-sm-10",style:{marginTop:"10px",position:"relative",left:"20px"},children:(0,c.jsx)("div",{style:{fontSize:"17px",fontWeight:"bold"},children:null===e.CD_USUARIO_OPERACAO?(0,c.jsx)("span",{style:{color:"transparent"},children:"PENDENTE"}):e.CD_USUARIO_OPERACAO})})]})},e.CD_ETAPA)))})})]})})})}),(0,c.jsxs)(n.ZP,{id:"alert",isCentered:!0,isAnimation:!1,isOpen:u,titleId:"alert",children:[(0,c.jsx)(n.xB,{style:{backgroundColor:p.COR,color:"#fff"},children:(0,c.jsx)(n.r6,{children:p.TITULO})}),(0,c.jsx)(n.fe,{className:"ModalBody",children:(0,c.jsx)("h3",{children:p.MSG})}),(0,c.jsx)(n.mz,{children:(0,c.jsx)(o.h,{isToolbar:"true",size:"lg",children:(0,c.jsx)(o.Z,{color:"light",onClick:()=>L(!1),children:"FECHAR"})})})]})]})]})}}}]);
//# sourceMappingURL=798.1349d30d.chunk.js.map