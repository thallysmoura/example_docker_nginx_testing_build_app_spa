"use strict";(self.webpackChunkapp_cc=self.webpackChunkapp_cc||[]).push([[826],{7425:(e,a,s)=>{s.r(a),s.d(a,{default:()=>D});var t=s(2791),r=s(97),l=s.n(r),i=s(6871),c=s(4619),n=s(1006),o=s(840),d=s(1649),h=s(7485),_=s(5409),x=s(1477),u=s(9757),j=s(9775),A=s(1595),m=s(5808);const p={grandArea:"style_grandArea__TZsFm",_area_teclado:"style__area_teclado__YJrzH",webcam_area:"style_webcam_area__PMWev",cam:"style_cam__j8HKV",area_header_info_patient:"style_area_header_info_patient__MUUFp",_area_photo_and_chapa:"style__area_photo_and_chapa__5Wkt5",_area_inputs:"style__area_inputs__mGSYh",btn_save:"style_btn_save__Yy4U9",input_chapa:"style_input_chapa__YyxZm"};var S=s(4455),g=s(2967),O=s(184);const D=()=>{const{isOnline:e}=(0,c.c)(),a=(0,i.s0)(),s=(0,i.TH)();let r,D;const C=(0,t.useRef)(null),v=(0,t.useRef)(null),[y,f]=(0,t.useState)([]),[N,P]=(0,t.useState)(""),[b,E]=(0,t.useState)(!1),[I,w]=(0,t.useState)(!1),[Z,T]=(0,t.useState)(null),[$,k]=(0,t.useState)(!1),[R,U]=(0,t.useState)(""),[B,H]=(0,t.useState)(!1),[M,V]=(0,t.useState)(!1);(0,t.useEffect)((()=>{s.state?f(s.state):a("/")}),[s,N,a]);const z=async(e,a,s,t,r,l,i,c)=>{switch(k(!1),c){case 0:k(!1),V(!0);break;case 1:E(!0),await F(e,a,s,t,r,l,i)}},F=async(e,a,s,t,r,l,i)=>{const c={image:`${e}`,badge:`${a}`,filename:`${l}`,user:`${s}`,aviso:`${t}`,etapa:`${r}`,autenticado:`${i}`},n=await J(c);console.log(JSON.stringify(n));try{const e=await g.Z.post("/salvarHistoricoAutenticacao",c);console.log(JSON.stringify(e))}catch(o){console.log(`error imageSave: ${o}`),console.log(Z)}},J=async e=>{const a=await g.Z.post("/uploadImage",e);console.log(a)},L=async(a,t)=>{if(v.current.value.length<4)return;if(k(!0),!e)return void alert("Voc\xea est\xe1 sem acesso \xe0 internet!");const r={imageSource:`${a}`,internCode:1,keyName:`${t}`,option:"compare",PAPEL_ACAO:156};try{const e=await g.Z.get(`/retornaCodUsuario?codchapa=${v.current.value}`);if(!e.data[0]){const e=(await g.Z.get(`/erroUserCracha/${t}`)).data;return k(!1),U(`${e}`),void H(!0)}const l=e.data[0].CD_USUARIO;if(console.log(l),D=await g.Z.post("/rekognition/face",r),!1===D.data[0].resposta||D.data[0].user!==l)return void await z(a,t,D.data[0].user,s.state.DADOS.COD_AVISO,s.state.DADOS.PROX_ETAPA,`${t}_${D.data[0].user}_${s.state.DADOS.COD_AVISO}_${s.state.DADOS.PROX_ETAPA}`,"N",D.data[0].codigo);await(async(e,a,s,t,r,l,i)=>{k(!1),w(!0),await F(e,a,s,t,r,l,i)})(a,t,D.data[0].user,s.state.DADOS.COD_AVISO,s.state.DADOS.PROX_ETAPA,`${t}_${D.data[0].user}_${s.state.DADOS.COD_AVISO}_${s.state.DADOS.PROX_ETAPA}`,"S"),await(async(e,a)=>{try{const s=await g.Z.post("/insertRepostasChecklist",{questionsCheckList:a,Usuario:e}),t=await s.data[0];t&&(console.clear(),console.log("================== DATA DE JEJUM QUE EST\xc1 SENDO CADASTRADA ========================="),console.log(t.dataHoraInicioJejum),console.log("================== DATA DE JEJUM QUE EST\xc1 SENDO CADASTRADA ========================="),T(t.dataHoraInicioJejum))}catch(s){console.log(s)}})(D.data[0].user,s.state.CHECKLIST),await X(D.data[0].user)}catch(l){console.log(l)}},X=async e=>{const s=new Date,t=new Date(s.getTime()),l={avisoCirurgia:y.DADOS.COD_AVISO,dtEtapa:t,cdEtapa:y.INFO_PROX_ETAPA.PROX_ETAPA.PROX_ETAPA,usuario:e,salaCirurgia:y.DADOS.DS_SAL_CIR,tipoAcao:"I",sublocalidade:y.CODIGO_SUB_LOCALIDADE};r=await g.Z.post("/avancarEtapasCirurgia",l),r||await z(),console.log(r),setTimeout(await(async()=>{a("/")})(),5e3)};return(0,O.jsxs)(n.Z,{title:d.Q.INDUCAO_ASSINATURA_CHECKLIST.text,children:[(0,O.jsx)(u.Z,{titulo:"Sala de Preparo",localidade:"Assinatura Colaborador",children:(0,O.jsxs)(j.ZP,{children:[(0,O.jsx)(j.Z_,{children:(0,O.jsx)(_.Z,{color:"light",icon:"menu",isLight:!0,children:(0,O.jsx)("p",{children:" "})})}),(0,O.jsx)(j.h_,{children:(0,O.jsx)(j.hP,{onClick:()=>(localStorage.removeItem("CAPP-local"),void a("/")),children:"Alterar Local"})})]})}),(0,O.jsxs)(o.Z,{children:[(0,O.jsxs)("div",{className:p.container,children:[(0,O.jsx)("header",{children:(0,O.jsx)("div",{children:(0,O.jsx)(A.ZP,{className:p.area_header_info_patient,children:(0,O.jsxs)(A.eW,{children:[(0,O.jsx)("h3",{children:"Paciente"}),(0,O.jsx)("h1",{children:y.DADOS?y.DADOS.PACIENTE:"- - "})]})})})}),(0,O.jsxs)("main",{className:p.grandArea,children:[(0,O.jsx)("div",{className:p._area_photo_and_chapa,children:(0,O.jsx)("div",{className:p.webcam_area,children:(0,O.jsx)(l(),{ref:C,className:p.cam,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{width:540,height:880,facingMode:"user"}})})}),(0,O.jsx)("div",{className:p._area_teclado,children:(0,O.jsxs)("div",{style:{padding:"1rem"},children:[(0,O.jsxs)("div",{style:{width:"400px"},children:[(0,O.jsx)("h2",{children:"Informe o c\xf3digo do crach\xe1"}),(0,O.jsx)(h.Z,{className:p.input_chapa,type:"number",disabled:!0,ref:v}),(0,O.jsx)("br",{})]}),(0,O.jsx)("div",{style:{width:"400px"},children:(0,O.jsx)(m.Z,{childToParent:e=>{const a=e;if("apagar"===a){const e=v.current.value.substring(0,v.current.value.length-1);v.current.value=e}else"zerar"===a?v.current.value="":(P(a),v.current.value+=a)}})}),(0,O.jsxs)("div",{className:p._area_inputs,children:[(0,O.jsx)("div",{children:(0,O.jsx)(_.Z,{className:p.btn_save,color:"success",icon:"user",onClick:()=>{const e=C.current.getScreenshot().replace("data:image/jpeg;base64,","");L(e,v.current.value)},children:"Assinar"})}),(0,O.jsx)("div",{children:(0,O.jsx)(S.Z,{onClick:()=>a(-1),icon:"reply",color:"#fff",size:"5x",forceFamily:"material"})})]})]})})]})]}),(0,O.jsxs)(x.ZP,{id:"example-modal",isOpen:b,titleId:"example-title",children:[(0,O.jsx)(x.xB,{className:"modal-header-error",children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsxs)("h1",{children:["Usu\xe1rio n\xe3o encontrado",(0,O.jsx)("br",{})]}),"Por favor, tente novamente."]}),(0,O.jsx)(x.mz,{children:(0,O.jsx)(_.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(_.Z,{className:"btn-style",color:"light",onClick:()=>{E(!1)},children:"FECHAR"})})})]}),(0,O.jsxs)(x.ZP,{id:"sucess-modal",isOpen:I,titleId:"example-titlea",children:[(0,O.jsx)(x.xB,{style:{backgroundColor:"#37BBAA"},children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:"ASSINADO COM SUCESSO!"}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]}),(0,O.jsxs)(x.ZP,{isOpen:B,children:[(0,O.jsx)(x.xB,{className:"modal-header-error",children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("h1",{children:R}),(0,O.jsx)("br",{})]}),(0,O.jsx)(x.mz,{children:(0,O.jsx)(_.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(_.Z,{className:"btn-style",color:"light",onClick:()=>H(!1),children:"FECHAR"})})})]}),(0,O.jsxs)(x.ZP,{isOpen:M,children:[(0,O.jsx)(x.xB,{className:"modal-header-error",children:(0,O.jsx)(x.r6,{id:"example-title",children:"AVISO"})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsxs)("h1",{children:["Face n\xe3o cadastrada!",(0,O.jsx)("br",{})]}),(0,O.jsx)("h3",{children:"Por favor, realize o cadastro e tente novamente."})]}),(0,O.jsx)(x.mz,{children:(0,O.jsx)(_.h,{isToolbar:"true",size:"lg",children:(0,O.jsx)(_.Z,{className:"btn-style",color:"light",onClick:()=>V(!1),children:"FECHAR"})})})]}),(0,O.jsxs)(x.ZP,{id:"loading",isOpen:$,titleId:"loading",children:[(0,O.jsx)(x.xB,{style:{backgroundColor:"#636363"},children:(0,O.jsx)(x.r6,{id:"example-title",children:"ASSINANDO..."})}),(0,O.jsxs)(x.fe,{className:"ModalBody",children:[(0,O.jsx)("br",{}),(0,O.jsx)("h1",{children:"Assinando...Por favor, aguarde..."}),(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})]})]})]})}}}]);
//# sourceMappingURL=826.c2c2a0a4.chunk.js.map